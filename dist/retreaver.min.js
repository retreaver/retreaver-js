/*! retreaver v0.2.26 | 2025-08-23 */if(!function(e){var t={configure:function(e){var r={addr:e.host,http_prefix:"http",urlregex:"/\\/\\/[^\\/]*\\/(.*)/"};void 0!==e.prefix&&(r.http_prefix=e.prefix),window.Retreaver._connection=new t.Base.Request(r)}};e.Retreaver=t}(window),!function(){void 0===window.Retreaver&&(window.Retreaver={});var e={};e.assert_required_keys=function(){for(var e=Array.prototype.slice.call(arguments),t=e.shift(),r=0;r<e.length;r++){var n=e[r];if(void 0===t||void 0===t[n])throw"ArgumentError: Required keys are not defined: "+e.join(", ")}return t},e.merge=function(t,r){for(var n in r)try{r[n].constructor==Object?t[n]=e.merge(t[n],r[n]):t[n]=r[n]}catch(e){t[n]=r[n]}return t},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.ieVersion=function(){return null==e._ieVersion&&(e._ieVersion=function(){for(var e=3,t=document.createElement("div"),r=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",r[0];);return e>4&&e}()),(6==e._ieVersion||7==e._ieVersion)&&null==Retreaver.easyxdm_loaded&&(Retreaver.easyxdm_loaded=!1),e._ieVersion},Retreaver.Base=e}(),!function(e){var t=function(e,r,n){return 1==arguments.length?t.get(e):t.set(e,r,n)};t._document=document,t._navigator=navigator,t.defaults={path:"/"},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[e]},t.set=function(e,r,n){return n=t._getExtendedOptions(n),t._document.cookie=t._generateCookieString(e,r,n),t},t._getExtendedOptions=function(r){return{path:r&&r.path||t.defaults.path,domain:r&&r.domain||t.defaults.domain,secure:r&&r.secure!==e?r.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._generateCookieString=function(e,t,r){return e=encodeURIComponent(e),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),(e=e+"="+t+((r=r||{}).path?";path="+r.path:"")+(r.domain?";domain="+r.domain:""))+(r.secure?";secure":"")},t._getCookieObjectFromString=function(r){var n={};r=r?r.split("; "):[];for(var i=0;i<r.length;i++){var a=t._getKeyValuePairFromCookieString(r[i]);n[a.key]===e&&(n[a.key]=a.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("="),t=0>t?e.length:t;return{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCookieObjectFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){return t._navigator.cookieEnabled||"1"===t.set("cookies.js",1).get("cookies.js")},t.enabled=t._areEnabled(),"function"==typeof define&&define.amd?define(function(){return t}):"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Cookies=t),Retreaver.Base.Cookies=t}(),!function(){var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};Base64.encode=function(e){var t,r,n,i,a,o,s,c="",d=0;for(e=Base64._utf8_encode(e);d<e.length;)t=e.charCodeAt(d++),r=e.charCodeAt(d++),n=e.charCodeAt(d++),i=t>>2,a=(3&t)<<4|r>>4,o=(15&r)<<2|n>>6,s=63&n,isNaN(r)?o=s=64:isNaN(n)&&(s=64),c=c+Base64._keyStr.charAt(i)+Base64._keyStr.charAt(a)+Base64._keyStr.charAt(o)+Base64._keyStr.charAt(s);return c},Base64.decode=function(e){var t,r,n,i,a,o,s,c="",d=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<e.length;)i=Base64._keyStr.indexOf(e.charAt(d++)),a=Base64._keyStr.indexOf(e.charAt(d++)),o=Base64._keyStr.indexOf(e.charAt(d++)),s=Base64._keyStr.indexOf(e.charAt(d++)),t=i<<2|a>>4,r=(15&a)<<4|o>>2,n=(3&o)<<6|s,c+=String.fromCharCode(t),64!=o&&(c+=String.fromCharCode(r)),64!=s&&(c+=String.fromCharCode(n));return c=Base64._utf8_decode(c)},Base64._utf8_encode=function(string){string=string.replace(eval("/\\r\\n/g"),eval("String('\\n')"));for(var utftext="",n=0;n<string.length;n++){var c=string.charCodeAt(n);c<128?utftext+=String.fromCharCode(c):(c>127&&c<2048?utftext+=String.fromCharCode(c>>6|192):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128)),utftext+=String.fromCharCode(63&c|128))}return utftext},Base64._utf8_decode=function(e){for(var t="",r=0,n=0,i=0,a=0;r<e.length;)(n=e.charCodeAt(r))<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(t+=String.fromCharCode((31&n)<<6|63&(i=e.charCodeAt(r+1))),r+=2):(i=e.charCodeAt(r+1),t+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&(a=e.charCodeAt(r+2))),r+=3);return t},Retreaver.Base.Base64=Base64}(),!function(){var e=Retreaver.Base,t=function(t){function r(){e.assert_required_keys(t,"type","primary_key"),void 0===Retreaver.Base.Data._store[t.type]&&(Retreaver.Base.Data._store[t.type]={}),void 0===Retreaver.Base.Data._store[t.type][t.primary_key]&&(Retreaver.Base.Data._store[t.type][t.primary_key]={})}var n=this;n.get=function(){var e={};if(void 0===arguments[0])e=Retreaver.Base.Data._store[t.type][t.primary_key];else if(1==arguments.length)e=Retreaver.Base.Data._store[t.type][t.primary_key][arguments[0]];else for(var r=0;r<arguments.length;r++){var n=arguments[r];e[n]=Retreaver.Base.Data._store[t.type][t.primary_key][n]}return e},n.set=function(e,r){return Retreaver.Base.Data._store[t.type][t.primary_key][e]=r,r},n.merge=function(e){for(var r in e)Retreaver.Base.Data._store[t.type][t.primary_key][r]=e[r];return e},r()};t._store={},Retreaver.Base.Data=t}(),!function(){var e=Retreaver.Base,t=Retreaver.Base.Data,r=function(){this.api_host_uri="/api/v1/",this.type="model",this.primary_key=function(e){return r.primary_key(this.type,e)},this.store=function(e){if(void 0!==e){var t=this.primary_key();if(void 0===e[t])throw"ArgumentError: Expected to receive primary_key "+t;void 0===this._store&&(this._store=new Retreaver.Base.Data({type:this.type,primary_key:e[t]}));this._store.merge(e),r.update_visitor_id(e)}return this._store},this.get_data=function(e,t){return this.connection().getJSON(this.api_host_uri+e,null,[r.update,t],this)},this.post_data=function(e,t,n){return this.connection().postJSON(this.api_host_uri+e,t,[r.update,n],this)},this.set=function(){return"function"==typeof this["set_"+arguments[0]]&&(arguments[1]=this["set_"+arguments[0]].apply(this,[arguments[1]])),this._store.set.apply(this,arguments)},this.get=function(){return this._store.get.apply(this,arguments)},this.connection=function(){return Retreaver.Base.Request.connection()}};r.inflections={number:"numbers",campaign:"campaigns"},r.update=function(n){for(var i in n){var a=i,o=n[i];if(void 0!==r.inflections[i]&&(a=r.inflections[i]),void 0!==t._store[a])if(e.isArray(o))for(var s=0;s<o.length;s++)r.update_record(a,o[s]);else r.update_record(a,o[s])}return n},r.update_record=function(e,t){if(r.update_visitor_id(t),void 0===t.id)return!1;var n=r.primary_key(e);for(var i in t)Retreaver.Base.Data._store[e][t[n]][i]=t[i];return!0},r.update_visitor_id=function(e){void 0!==e&&void 0!==e.visitor_id&&Retreaver.Base.Cookies.set("CallPixels-vid",e.visitor_id)},r.primary_key=function(e,t){return void 0===r.primary_keys&&(r.primary_keys={}),void 0===r.primary_keys[e]&&(r.primary_keys[e]="id"),void 0!==t&&(r.primary_keys[e]=t),r.primary_keys[e]},Retreaver.Base.Model=r}(),!function(){var Base=window.Retreaver.Base,Cookies=window.Retreaver.Base.Cookies,Request=function(options){function initialize(e){config=Base.assert_required_keys(e,"http_prefix","addr","urlregex")}var self=this,config={};function with_ie_scripts(e){Retreaver.easyxdm_loaded?e():self.loadScript(http_prefix+"://cdn.jsdelivr.net/easyxdm/2.4.17.1/easyXDM.min.js",function(){self.loadScript(http_prefix+"://cdn.jsdelivr.net/easyxdm/2.4.17.1/json2.js",function(){Retreaver.easyxdm_loaded=!0,e()})})}self.getJSON=function(e,t,r,n){"function"==typeof r&&(r=[r]),void 0===n&&(n=self);var i=function(){self.apiRequest(e,function(e){var t=JSON.parse(e);for(var i in r)"function"==typeof r[i]&&r[i].apply(n,[t])},t)};6==Base.ieVersion()||7==Base.ieVersion()?with_ie_scripts(i):i()},self.postJSON=function(){return self.getJSON.apply(this,arguments)},self.apiRequest=function(request_uri,callbackFunctions,payload){var http_prefix=config.http_prefix,addr=config.addr,urlregex=eval(config.urlregex),request_url=http_prefix+"://"+addr+request_uri;function ignored(){}function runCallbacks(e){for(var t in callbackFunctions)"function"==typeof callbackFunctions[t]&&callbackFunctions[t](e)}function forwardResponse(){runCallbacks(xdr.responseText)}function sendXdm(){var remote=http_prefix+"://"+addr+"/ie_provider",swf=http_prefix+"://"+addr+"/easyxdm.swf",rpc=eval('new window.easyXDM.Rpc({ remote: "'+remote+'", swf: "'+swf+'"},{remote: {request: {}}});');rpc.request({url:"/"+request_url.match(urlregex)[1],method:"POST",data:payload},function(e){runCallbacks(e.data)})}if(payload&&void 0!==Cookies.get("CallPixels-vid")&&"null"!==Cookies.get("CallPixels-vid")&&(payload.visitor_id=Cookies.get("CallPixels-vid")),"function"==typeof callbackFunctions&&(callbackFunctions=[callbackFunctions]),window.XDomainRequest){var xdr=new XDomainRequest;xdr.onload=forwardResponse,xdr.onprogress=ignored,xdr.onerror=ignored,xdr.ontimeout=ignored,xdr.timeout=3e4,payload?(xdr.open("post",request_url),xdr.send(self.buildPost(payload))):(xdr.open("get",request_url),xdr.send())}else if(6==Base.ieVersion()||7==Base.ieVersion())with_ie_scripts(sendXdm);else{var request=new XMLHttpRequest;request.onload=function(){runCallbacks(this.responseText)},payload?(request.open("POST",request_url),request.setRequestHeader("Content-Type","application/json"),request.send(JSON.stringify(payload))):(request.open("GET",request_url),request.send())}},self.buildPost=function(e){var t="";for(var r in e)t+=r+"="+e[r]+"&";return t},self.loadScript=function(e,t){var r=document.getElementsByTagName("script")[0],n=document.createElement("script");n.type="text/javascript",n.async=!1,n.src=e;var i=function(e,t){"loaded"==e.readyState||"complete"==e.readyState?t():setTimeout(function(){i(e,t)},100)};"function"==typeof t&&(void 0!==n.addEventListener?n.addEventListener("load",t,!1):n.onreadystatechange=function(){n.onreadystatechange=null,i(n,t)}),r.parentNode.insertBefore(n,r)},initialize(options),self.config=config};Request.connection=function(){if(void 0===window.Retreaver._connection){var e=window.location.protocol.replace(":","");window.Retreaver._connection=new Retreaver.Base.Request({addr:"api.rtvrapi.com",http_prefix:e,urlregex:"/\\/\\/[^\\/]*\\/(.*)/"})}return window.Retreaver._connection},Retreaver.Base.Request=Request}(),!function(){var Base=Retreaver.Base,Cookies=Retreaver.Base.Cookies,Base64=Retreaver.Base.Base64,Request=Retreaver.Base.Request,RequestNumber=function(options){function initialize(e){config=Base.assert_required_keys(e,"campaign_key")}var self=this,config={},resource_url="/api/v1/numbers?";function getParts(e){for(var t={},r=0;r<e.length;r++){var n=getUrlParts(e[r]);for(var i in n)t[i]=n[i]}return t}function getUrlParts(url){var objURL={};try{url=url.match(eval("/\\?(.*)/"))[0]}catch(e){return objURL}return url.replace(RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,t,r,n){objURL[t.toLowerCase()]=n}),objURL}function getGACookies(){var e=["__utma","__utmb","__utmc","__utmz","__utmv"],t={};for(var r in e){var n=extractCookie(e[r]);if(n||r>0)n&&(t[e[r]]=n);else break}return t}function extractCookie(e){var t=RegExp(e+"=([^;]*)","g");try{return t.exec(document.cookie)[1]}catch(e){return!1}}function findOne(e,t){for(var r in t)for(var n in e)if(n==t[r])return e[n];return!1}self.perform=function(callback){if("function"!=typeof callback)throw"ArgumentError: Expected to receive a callback function";var request_url=resource_url+"&campaign_key="+config.campaign_key;config.default_number_replacement&&(request_url=request_url+"&default_number="+config.default_number_replacement),config.message_replacement&&(request_url=request_url+"&message="+config.message_replacement);var body={},uri=document.location.href;body.u=Base64.encode(uri),body.st=Base64.encode(tags_to_script_tags(config.number_matching_tags));var ou=Cookies.get("CallPixels-ou");getParts([document.location.href]).cpreset||!ou?Cookies.set("CallPixels-ou",body.u):body.ou=ou;var ga_acct="FAILED",request_ran=!1;function sendGARequest(e,t){request_ran||(request_ran=!0,body.ga=Base64.encode(e),body.c=Base64.encode(JSON.stringify(t)),Request.connection().getJSON(request_url,body,callback))}function runRequest(){request_ran||(request_ran=!0,Request.connection().getJSON(request_url,body,callback))}window.setTimeout(runRequest,1e3);try{_gaq.push(function(){ga_acct=eval("_gat._getTrackerByName()._getAccount()"),sendGARequest(ga_acct,getGACookies())})}catch(e){try{ga(function(tracker){if(tracker&&tracker.get)try{var clientId=tracker.get("clientId"),allTrackers=eval("ga.getAll()");ga_acct=allTrackers[0].get("trackingId");var ga_cookies={};ga_cookies.__utma=clientId,ga_cookies.mp="yes",sendGARequest(ga_acct,ga_cookies)}catch(g){sendGARequest("",{})}else sendGARequest("",{})})}catch(f){runRequest()}}},initialize(options)};function tags_to_script_tags(e){var t="";for(var r in e){var n=e[r];t=t+"&"+r+"="+n}return t}Retreaver.Base.RequestNumber=RequestNumber}(),window.Retreaver.Cache={},!function(){var e=Retreaver.Base;function t(e){if(void 0!==Retreaver.Base.Data._store){var r=Retreaver.Base.Data._store.numbers;if(void 0!==r){var n={};for(var i in r){var a=r[i];"true"===a.is_active&&(void 0===n[a.campaign_key]&&(n[a.campaign_key]=[],n[a.campaign_key].ids=[],n[a.campaign_key].hashes=[]),n[a.campaign_key].ids.push(a.id),n[a.campaign_key].hashes.push(a.id_checksum))}for(var o in n){var s={ids:n[o].ids,hashes:n[o].hashes};Retreaver.Base.Request.connection().postJSON("/api/v1/numbers/ping",s,[Retreaver.Base.Model.update,e],this)}}}setTimeout(t,15e3)}Retreaver.Number=function(t){var r=this;function n(e){r.store(e),r.set("is_active","true")}function i(e){return"string"==typeof e&&(e=Retreaver.Number.extract_tags_from_string(e)),{tag_values:e,ids:[a("id")],campaign_key:a("campaign_key")}}function a(e){return r.get(e)}function o(){if(!1===r.get("is_per_visitor"))throw"Error: Tried to add tags to non per-visitor number."}r.type="numbers",r.add_tags=function(e,t){o(),r.post_data("numbers/tag",i(e),t)},r.replace_tags=function(e,t){o(),r.post_data("numbers/replace_tags",i(e),t)},r.remove_tags=function(e,t){o(),r.post_data("numbers/untag",i(e),t)},r.remove_tags_by_keys=function(e,t){o(),"string"==typeof e&&(e=e.split(","));var n={tag_keys:e,ids:[a("id")],campaign_key:a("campaign_key")};r.post_data("numbers/untag/keys",n,t)},r.clear_tags=function(e){o();var t={ids:[a("id")],campaign_key:a("campaign_key"),all:"true"};r.post_data("numbers/untag",t,e)},r.release=function(){r.set("is_active","false")},r.initiate_call=function(t,n,i){void 0===n&&(n={}),n.dial=t,n=e.merge(r.get("id","campaign_key"),n),r.post_data("numbers/initiate_call",n,i)},n(t)},Retreaver.Number.extract_tags_from_string=function(e){for(var t={},e=e.split(","),r=0;r<e.length;r++){var n=e[r].split(":");t[n[0]]=n[1]}return t},Retreaver.Number.prototype=new Retreaver.Base.Model,t()}(),!function(){var e=Retreaver.Base.RequestNumber,t=function(t){function r(e){d.store(e)}function n(e){for(var t=0;t<e.length;t++){var r=e[t];Retreaver.Vendor.findAndReplaceDOMText(document.getElementsByTagName("body")[0],{find:r.find,replace:r.replace_with});for(var n=document.getElementsByTagName("a"),i=0;i<n.length;i++){var a=n[i],o=a.getAttribute("href");if(null!==o){var s=o.match(/^(tel:|clk[a-z]\/tel\/)(.*)/);s&&s[2]===r.find&&a.setAttribute("href",s[1]+r.replace_with)}}}}function i(e,t){let r=e.get("integrations");if("object"!=typeof r)return;let n=r[t];if(void 0!==n)return n}function a(e){if("undefined"!=typeof(googleAnalyticsConfig=i(e,"google_analytics")))new Promise(function(e){let t=setInterval(function(){let r=/_ga_[^=]+=([^;]*)/,n=document.cookie.match(r),i=n&&n[1],a=/_ga=([^;]*)/,o=document.cookie.match(a),s=o&&o[1];i&&s&&(e({gaSessionId:i,gaClientId:s}),clearInterval(t))},googleAnalyticsConfig.checkIntervalMs)}).then(function(t){e.replace_tags({ga_session_id:t.gaSessionId,ga_client_id:t.gaClientId})})}function o(e){let t=i(e,"truecall.com");if(void 0===t)return;document.getElementById("__tc_script")&&window.TrueCall||function(){let e=document.createElement("script");e.type="text/javascript",e.async=!0,e.defer=!0,e.dataset.campaign_uuid=t.tcCampaignUuid,e.dataset.use_set_did="1",e.id="__tc_script",e.src=t.scriptSrc,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();let r=setInterval(function(){window.TrueCall&&window.TrueCall.setDID(e.get("number")).then(function(){return clearInterval(r),window.TrueCall.getIdAsync()}).then(function(r){let n={};n[t.tagName]=r,e.replace_tags(n)})},t.checkIntervalMs)}function s(e){let t=i(e,"red_track");if(void 0!==t)new Promise(function(e){let n=setInterval(function(){let t=r("rtkclickid-store");t&&(e(t),clearInterval(n))},t.checkIntervalMs)}).then(function(r){let n={};n[t.tagName]=r,e.replace_tags(n)});function r(e){let t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()}}function c(e){let t=i(e,"click_flare");if(void 0===t)return;let r=function(){if(window.clickflare&&window.clickflare.data&&window.clickflare.data.event_tokens)return window.clickflare.data.event_tokens.cv_click_id||window.clickflare.data.event_tokens.cf_click_id};new Promise(function(e){let n=setInterval(function(){let t=r();t&&(e(t),clearInterval(n))},t.checkIntervalMs)}).then(function(r){let n={};n[t.tagName]=r,e.replace_tags(n)})}var d=this;d.type="campaigns",d.primary_key("campaign_key"),d.numbers=[],d.request_number=function(t,r,i){"function"==typeof t&&(i=r,r=t,t={}),void 0===r&&(r=function(){}),void 0===t&&(t={}),d.set("number_matching_tags",t),new e(d.get("campaign_key","number_matching_tags")).perform(function(e){if(void 0!==e&&void 0!==e.number&&""!==e.number){var t=new Retreaver.Number(e.number);try{o(t)}catch(e){console.error("Could not integrate with truecall.com, ",e)}try{s(t)}catch(e){console.error("Could not integrate with Red Track, ",e)}try{a(t)}catch(e){console.error("Could not integrate with google analytics, ",e)}try{c(t)}catch(e){console.error("Could not integrate with click flare, ",e)}void 0!==e.number.replacement_numbers&&n(e.number.replacement_numbers),r.apply(d,[t])}else"function"==typeof i&&i.apply(d,[e])})},d.auto_replace_numbers=function(e,t,r){void 0===t&&(t=function(){}),void 0===r&&(r=function(){}),d.request_number(e,t,r)},d.numbers=function(){var e=[];if(void 0!==Retreaver.Base.Data._store){var t=Retreaver.Base.Data._store.numbers;if(void 0!==t)for(var r in t){var n=t[r];d.get("campaign_key")==n.campaign_key&&e.push(new Retreaver.Number(n))}}return e},d.set_number_matching_tags=function(e){if("string"==typeof e&&(e=Retreaver.Number.extract_tags_from_string(e)),e&&"object"==typeof e&&!(e instanceof Array))return e;throw"ArgumentError: Expected number_matching_tags to be an object. eg: {tag: 'value'}"},r(t)};t.prototype=new Retreaver.Base.Model,Retreaver.Campaign=t}(),!function(e){e.Callpixels=window.Retreaver}(window),void 0===Retreaver)var Retreaver={};void 0===Retreaver.Vendor&&(Retreaver.Vendor={}),!function(e,t){e.findAndReplaceDOMText=t()}(Retreaver.Vendor,function(){var e="retain",t="first",r=document,n={}.hasOwnProperty;function i(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function a(){return o.apply(null,arguments)||s.apply(null,arguments)}function o(e,t,r,n,i){if(t&&!t.nodeType&&arguments.length<=2)return!1;var o="function"==typeof r;o&&(r=function(e){return function(t,r){return e(t.text,r.startIndex)}}(r));var c=s(t,{find:e,wrap:o?null:r,replace:o?r:"$"+(n||"&"),prepMatch:function(e,t){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(n>0){var r=e[n];e.index+=e[0].indexOf(r),e[0]=r}return e.endIndex=e.index+e[0].length,e.startIndex=e.index,e.index=t,e},filterElements:i});return a.revert=function(){return c.revert()},!0}function s(e,t){return new c(e,t)}function c(t,r){var i=r.preset&&a.PRESETS[r.preset];if(r.portionMode=r.portionMode||e,i)for(var o in i)n.call(i,o)&&!n.call(r,o)&&(r[o]=i[o]);this.node=t,this.options=r,this.prepMatch=r.prepMatch||this.prepMatch,this.reverts=[],this.matches=this.search(),this.matches.length&&this.processMatches()}return a.NON_PROSE_ELEMENTS={br:1,hr:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1},a.NON_CONTIGUOUS_PROSE_ELEMENTS={address:1,article:1,aside:1,blockquote:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,ul:1,br:1,li:1,summary:1,dt:1,details:1,rp:1,rt:1,rtc:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1,table:1,tbody:1,thead:1,th:1,tr:1,td:1,caption:1,col:1,tfoot:1,colgroup:1},a.NON_INLINE_PROSE=function(e){return n.call(a.NON_CONTIGUOUS_PROSE_ELEMENTS,e.nodeName.toLowerCase())},a.PRESETS={prose:{forceContext:a.NON_INLINE_PROSE,filterElements:function(e){return!n.call(a.NON_PROSE_ELEMENTS,e.nodeName.toLowerCase())}}},a.Finder=c,c.prototype={search:function(){var e,t=0,r=0,n=this.options.find,a=this.getAggregateText(),o=[],s=this;function c(i){for(var a=0,d=i.length;a<d;++a){var u=i[a];if("string"!=typeof u){c(u);continue}if(n.global)for(;e=n.exec(u);)o.push(s.prepMatch(e,t++,r));else(e=u.match(n))&&o.push(s.prepMatch(e,0,r));r+=u.length}}return n="string"==typeof n?RegExp(i(n),"g"):n,c(a),o},prepMatch:function(e,t,r){if(!e[0])throw Error("findAndReplaceDOMText cannot handle zero-length matches");return e.endIndex=r+e.index+e[0].length,e.startIndex=r+e.index,e.index=t,e},getAggregateText:function(){var e=this.options.filterElements,t=this.options.forceContext;return r(this.node);function r(n){if(3===n.nodeType)return[n.data];if(e&&!e(n))return[];var i=[""],a=0;if(n=n.firstChild)do{if(3===n.nodeType){i[a]+=n.data;continue}var o=r(n);t&&1===n.nodeType&&(!0===t||t(n))?(i[++a]=o,i[++a]=""):("string"==typeof o[0]&&(i[a]+=o.shift()),o.length&&(i[++a]=o,i[++a]=""))}while(n=n.nextSibling);return i}},processMatches:function(){var e=this.matches,t=this.node,r=this.options.filterElements,n,i,a,o=[],s=t,c=e.shift(),d=0,u=0,f=[t];e:for(;;){if(3===s.nodeType&&(!i&&s.length+d>=c.endIndex?i={node:s,index:u++,text:s.data.substring(c.startIndex-d,c.endIndex-d),indexInMatch:d-c.startIndex,indexInNode:c.startIndex-d,endIndexInNode:c.endIndex-d,isEnd:!0}:n&&o.push({node:s,index:u++,text:s.data,indexInMatch:d-c.startIndex,indexInNode:0}),!n&&s.length+d>c.startIndex&&(n={node:s,index:u++,indexInMatch:0,indexInNode:c.startIndex-d,endIndexInNode:c.endIndex-d,text:s.data.substring(c.startIndex-d,c.endIndex-d)}),d+=s.data.length),a=1===s.nodeType&&r&&!r(s),n&&i){s=this.replaceMatch(c,n,o,i),d-=i.node.data.length-i.endIndexInNode,n=null,i=null,o=[],c=e.shift(),u=0;if(!c)break}else if(!a&&(s.firstChild||s.nextSibling)){s.firstChild?(f.push(s),s=s.firstChild):s=s.nextSibling;continue}for(;;){if(s.nextSibling){s=s.nextSibling;break}if((s=f.pop())===t)break e}}},revert:function(){for(var e=this.reverts.length;e--;)this.reverts[e]();this.reverts=[]},prepareReplacementString:function(e,r,n){var i=this.options.portionMode;return i===t&&r.indexInMatch>0?"":(e=e.replace(/\$(\d+|&|`|')/g,function(e,t){var r;switch(t){case"&":r=n[0];break;case"`":r=n.input.substring(0,n.startIndex);break;case"'":r=n.input.substring(n.endIndex);break;default:r=n[+t]}return r}),i===t)?e:r.isEnd?e.substring(r.indexInMatch):e.substring(r.indexInMatch,r.indexInMatch+r.text.length)},getPortionReplacementNode:function(e,t){var n=this.options.replace||"$&",i=this.options.wrap;if(i&&i.nodeType){var a=r.createElement("div");a.innerHTML=i.outerHTML||new XMLSerializer().serializeToString(i),i=a.firstChild}if("function"==typeof n)return(n=n(e,t))&&n.nodeType?n:r.createTextNode(String(n));var o="string"==typeof i?r.createElement(i):i;return(n=r.createTextNode(this.prepareReplacementString(n,e,t))).data&&o?(o.appendChild(n),o):n},replaceMatch:function(e,t,n,i){var a,o,s=t.node,c=i.node;if(s===c){var d=s;t.indexInNode>0&&(a=r.createTextNode(d.data.substring(0,t.indexInNode)),d.parentNode.insertBefore(a,d));var u=this.getPortionReplacementNode(i,e);return d.parentNode.insertBefore(u,d),i.endIndexInNode<d.length&&(o=r.createTextNode(d.data.substring(i.endIndexInNode)),d.parentNode.insertBefore(o,d)),d.parentNode.removeChild(d),this.reverts.push(function(){a===u.previousSibling&&a.parentNode.removeChild(a),o===u.nextSibling&&o.parentNode.removeChild(o),u.parentNode.replaceChild(d,u)}),u}a=r.createTextNode(s.data.substring(0,t.indexInNode)),o=r.createTextNode(c.data.substring(i.endIndexInNode));for(var f=this.getPortionReplacementNode(t,e),l=[],p=0,v=n.length;p<v;++p){var h=n[p],g=this.getPortionReplacementNode(h,e);h.node.parentNode.replaceChild(g,h.node),this.reverts.push(function(e,t){return function(){t.parentNode.replaceChild(e.node,t)}}(h,g)),l.push(g)}var _=this.getPortionReplacementNode(i,e);return s.parentNode.insertBefore(a,s),s.parentNode.insertBefore(f,s),s.parentNode.removeChild(s),c.parentNode.insertBefore(_,c),c.parentNode.insertBefore(o,c),c.parentNode.removeChild(c),this.reverts.push(function(){a.parentNode.removeChild(a),f.parentNode.replaceChild(s,f),o.parentNode.removeChild(o),_.parentNode.replaceChild(c,_)}),_}},a});